<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<link rel="stylesheet" href="./index.css" />
		<style>
			.button {
				position: fixed;
				top: 50%;
				left: 50%;
				z-index: 99;
			}
		</style>
	</head>
	<body>
		<div
			class="img-pre__container img-pre__animated show"
			id="J_container"
			style="--container-opcity: 0.7; --header-bg-opcity: 0.2"
		>
			<div class="img-pre__header img-pre__animated">
				<div class="img-pre__nums">
					<p>
						<span id="img-pre__current-index">1</span>
						<span class="img-pre__nums-delimiter">-</span>
						<span id="img-pre__total-index">12</span>
					</p>
				</div>
				<div class="img-pre__bottons">
					<button class="img-pre__button-item" data-tooltip="{{RESET}}">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="16"
							height="16"
							fill="currentColor"
							class="bi bi-view-list"
							viewBox="0 0 16 16"
						>
							<path
								d="M3 4.5h10a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2zm0 1a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1H3zM1 2a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 2zm0 12a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 0 1h-13A.5.5 0 0 1 1 14z"
							/>
						</svg>
					</button>
					<button class="img-pre__button-item" data-tooltip="{{ROTATE_LEFT}}">
						<svg
							t="1639647288997"
							class="icon"
							viewBox="0 0 1024 1024"
							version="1.1"
							xmlns="http://www.w3.org/2000/svg"
							p-id="1423"
							width="16"
							height="16"
						>
							<path
								d="M725.996 383.57H74.558A74.782 74.782 0 0 0 0 458.126v491.315A74.782 74.782 0 0 0 74.558 1024h651.438a74.782 74.782 0 0 0 74.558-74.558V458.127a74.782 74.782 0 0 0-74.558-74.558z m10.528 565.872a10.816 10.816 0 0 1-10.528 10.528H74.558a10.816 10.816 0 0 1-10.528-10.528V458.127c0-5.6 4.928-10.528 10.528-10.528h651.438c5.6 0 10.528 4.928 10.528 10.528v491.315z"
								p-id="1424"
								fill="#ffffff"
							></path>
							<path
								d="M1023.94 533.165C986.117 355.73 849.93 202.038 668.558 132.088a592.112 592.112 0 0 0-234.33-39.551l36.511-38.463A32 32 0 1 0 424.341 9.98l-96.094 101.15a32 32 0 0 0 1.184 45.278l96.062 90.974a31.935 31.935 0 0 0 45.246-1.248 32 32 0 0 0-1.216-45.279l-46.75-44.319a529.17 529.17 0 0 1 222.746 35.231c161.403 62.239 282.392 198.139 315.703 354.647a32.063 32.063 0 0 0 62.718-13.248z"
								p-id="1425"
								fill="#ffffff"
							></path>
						</svg>
					</button>
					<button class="img-pre__button-item" data-tooltip="{{ROTATE_RIGHT}}">
						<svg
							t="1639647310917"
							class="icon"
							viewBox="0 0 1025 1024"
							version="1.1"
							xmlns="http://www.w3.org/2000/svg"
							p-id="1652"
							width="16"
							height="16"
						>
							<path
								d="M0.69753 525.673495a31.720891 31.720891 0 0 0 25.581364 37.860419 32.744146 32.744146 0 0 0 38.372045-23.534855 502.929616 502.929616 0 0 1 320.790305-350.464687A557.673735 557.673735 0 0 1 611.580501 154.23209l-48.092964 44.511573a28.1395 28.1395 0 0 0-10.232546 21.999973 31.209264 31.209264 0 0 0 8.697664 22.511601 33.255773 33.255773 0 0 0 46.046455 0L706.231548 154.23209a32.744146 32.744146 0 0 0 10.232546-21.999973 31.720891 31.720891 0 0 0-9.209291-22.5116L609.533992 10.464824a33.255773 33.255773 0 0 0-31.209264-9.720918 32.232519 32.232519 0 0 0-23.534855 21.488346A31.209264 31.209264 0 0 0 563.487537 51.906634l37.348791 37.860419a626.743417 626.743417 0 0 0-237.906685 38.883673 566.883026 566.883026 0 0 0-358.139095 394.97626z m269.115949 420.045996a11.767427 11.767427 0 0 0 10.744172 10.744173h665.115464a10.744173 10.744173 0 0 0 10.744173-10.744173V435.627094a10.744173 10.744173 0 0 0-10.744173-10.744173h-665.115464a11.2558 11.2558 0 0 0-10.744172 10.744173v511.627279zM281.069279 358.883002h665.115463A77.255719 77.255719 0 0 1 1023.952089 435.627094v511.627279a76.744092 76.744092 0 0 1-77.25572 76.744092h-665.115463A76.744092 76.744092 0 0 1 205.348441 945.719491V435.627094A77.255719 77.255719 0 0 1 281.069279 358.883002z"
								p-id="1653"
								fill="#ffffff"
							></path>
						</svg>
					</button>
					<button class="img-pre__button-item" data-tooltip="{{CLOSE}}">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="16"
							height="16"
							fill="currentColor"
							class="bi bi-x-lg"
							viewBox="0 0 16 16"
						>
							<path
								fill-rule="evenodd"
								d="M13.854 2.146a.5.5 0 0 1 0 .708l-11 11a.5.5 0 0 1-.708-.708l11-11a.5.5 0 0 1 .708 0Z"
							/>
							<path
								fill-rule="evenodd"
								d="M2.146 2.146a.5.5 0 0 0 0 .708l11 11a.5.5 0 0 0 .708-.708l-11-11a.5.5 0 0 0-.708 0Z"
							/>
						</svg>
					</button>
				</div>
			</div>
			<div class="img-pre__contet-warpper" id="J_content-warpper" style="--index: 0">
				<div class="img-pre__img-item img-pre__animated current-index" id="J_current-index">
					<img src="../demo/img/pexels-photo-1006121.jpeg" />
				</div>
				<!-- <div class="img-pre__img-item img-pre__animated next-index">
					<img
						src="../demo/img/pexels-photo-1172064.jpeg"
						width="500"
						alt=""
						class="img-pre__animated next-index"
					/>
				</div> -->
			</div>
		</div>
		<div class="button">
			<button id="button">1111</button>
			<button id="prev">上一张</button>
			<button id="next">下一张</button>
		</div>
		<!-- <div class="warpper">
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p id="target_el">目标元素</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
			<p>asfdfasdf</p>
		</div> -->
		<script src="./img-previewer.js"></script>
		<script>
			// const a = new ImgPreviewer('body', {
			// 	zoom: {
			// 		max: 10
			// 	}
			// })
			// console.log(123123123)
			// console.log(a)
			// 定义一个交叉观察器
			// const io = new IntersectionObserver((ioes) => {
			// 	console.log(ioes)
			// 	ioes.forEach((ioe) => {
			// 		const el = ioe.target
			// 		const intersectionRatio = ioe.intersectionRatio
			// 		if (intersectionRatio > 0 && intersectionRatio <= 1) {
			// 			// loadImg(el)
			// 			console.log('出现')
			// 			io.unobserve(el)
			// 		}
			// 		el.onload = el.onerror = () => io.unobserve(el)
			// 	})
			// })
			// // 执行交叉观察器
			// function isInViewPortOfThree(el) {
			// 	io.observe(el)
			// }
			// const a = document.getElementById('target_el')
			const el = document.getElementById('J_container')
			el.addEventListener('animationend', (e) => {
				console.log('动画结束', e)
			})
			let el1 = document.getElementById('button')
			el1.addEventListener('click', () => {
				let classList = el.classList
				console.log(classList)
				if (classList.value.indexOf('show') !== -1) {
					el.classList.remove('show')
					el.classList.add('hide')
				} else {
					el.classList.remove('hide')
					el.classList.add('show')
				}
			})

			const prevButton = document.getElementById('prev')
			const nextButton = document.getElementById('next')
			let imgSrcList = [
				'../demo/img/pexels-photo-1006121.jpeg',
				'../demo/img/pexels-photo-1172064.jpeg',
				'../demo/img/pexels-photo-53893.jpeg'
			]
			const index = ((value) =>
				Object.defineProperty({}, 'value', {
					enumerable: false,
					set(newVal) {
						value = newVal
						if (newVal === 0) {
							prevButton.disabled = true
						} else {
							prevButton.disabled = false
						}
						if (newVal === imgSrcList.length - 1) {
							nextButton.disabled = true
						} else {
							nextButton.disabled = false
						}
						// console.log('状态变化', newVal)
						// if (newVal === 'packed') pushAssets()
					},
					get() {
						return value
					}
				}))(0)
			function nextTick(cal) {
				requestAnimationFrame(cal)
			}
			const warpper = document.getElementById('J_content-warpper')
			prevButton.addEventListener('click', () => {
				if (index.value > 0) {
					index.value -= 1
					warpper.style.setProperty('--index', index.value)
				} else {
					return
				}
				const div = document.createElement('div')
				const img = document.createElement('img')
				div.classList.add('img-pre__img-item', 'slide-right-in')
				img.src = imgSrcList[index.value]
				div.appendChild(img)

				warpper.appendChild(div)
				const currentIndex = document.getElementById('J_current-index')
				currentIndex.classList.add('slide-right-out')
				currentIndex.addEventListener('animationend', () => {
					warpper.removeChild(currentIndex)
				})
				div.addEventListener('animationend', () => {
					div.classList.remove('slide-right-in')
					div.classList.add('current-index')
					div.id = 'J_current-index'
				})
			})
			nextButton.addEventListener('click', () => {
				if (index.value < imgSrcList.length - 1) {
					index.value += 1
					warpper.style.setProperty('--index', index.value * -1)
				} else {
					return
				}
				const div = document.createElement('div')
				const img = document.createElement('img')
				div.classList.add('img-pre__img-item', 'slide-left-in')
				img.src = imgSrcList[index.value]
				div.appendChild(img)
				warpper.appendChild(div)
				const currentIndex = document.getElementById('J_current-index')
				currentIndex.classList.add('slide-left-out')
				currentIndex.addEventListener('animationend', () => {
					warpper.removeChild(currentIndex)
				})
				div.addEventListener('animationend', () => {
					div.classList.remove('slide-left-in')
					div.classList.add('current-index')
					div.id = 'J_current-index'
				})
			})
		</script>
	</body>
</html>
